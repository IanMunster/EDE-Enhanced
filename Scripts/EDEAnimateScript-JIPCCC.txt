scn EDEAnimateScript

ref rCurrEdeRef
int bHasFacePlate

Begin Function { rCurrEdeRef }
	set EDEQuest.bIsAnimating to 1
	set bHasFacePlate to rCurrEdeRef.CreatureHasModel "AnimEDExFaceA.nif"
	if (GetUnconscious) || (GetDead) 
		SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\AnimEDExDeadFaceA"
		SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExDeadFaceC"
	elseif (IsInCombat)
		SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\AnimEDExMadFaceA"
		SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExMadFaceC"
	elseif (EDEQuest.bIsCloaked == 1) && (bHasFacePlate == 1)	;// Remove FacePlate when Invisible
		rCurrEdeRef.ToggleCreatureModel "AnimEDExFaceA.nif" 0
		rCurrEdeRef.Update3D
		set bHasFacePlate to 0
	elseif (EDEQuest.bIsCloaked == 0) && (bHasFacePlate == 0)	;// Add FacePlate when NOT Invisible
		rCurrEdeRef.ToggleCreatureModel "AnimEDExFaceA.nif" 1
		rCurrEdeRef.Update3D
		set bHasFacePlate to 1
	else
		if (IsSoundPlaying NPCRobotEdEHappy rCurrEdeRef) || ((rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleHappy) && (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef == 0))
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacehappy"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
		elseif (IsSoundPlaying NPCRobotEdEConfirmed rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefaceyes"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
; JIPCCC Support WIP
		elseif (IsSoundPlaying NPCRobotEdETriumphant rCurrEdeRef) || ((rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleHappy) && (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef == 0)) || (JIPCCCActiveTasks.iTask == 13) ;JIPCCC
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacetriumph"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
		elseif (IsSoundPlaying NPCRobotEdELaugh rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacelaugh"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
		elseif (IsSoundPlaying NPCRobotEdEGoodbyeHappy rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacegoodbyehappy"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
		elseif (IsSoundPlaying NPCRobotEdEHydaulicDoor rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacehelpfull"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExFaceC"
		elseif (IsSoundPlaying NPCRobotEdEAlertLowHealth rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleScared)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacepanic"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExMadFaceC"
		elseif (IsSoundPlaying NPCRobotEdEDenied rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefaceNo"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExMadFaceC"
		elseif (IsSoundPlaying NPCRobotEdEAnger rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleAngry)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\AnimEDExMadFaceA"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\AnimEDExMadFaceC"
		elseif (IsSoundPlaying NPCRobotEdECurious rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacecurious"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdEAlertThreat rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefaceseek"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
; JIPCCC Support WIP
		elseif (IsSoundPlaying NPCRobotEdESonarBeep rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 9) || (JIPCCCActiveTasks.iTask == 10) ;JIPCCC
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacesneak"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
; JIPCCC Support WIP
		elseif (IsSoundPlaying NPCRobotEdEHomingBeep rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 8) || (JIPCCCActiveTasks.iTask == 11) ;JIPCCC
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacefollow"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
; JIPCCC Support WIP
		elseif (IsSoundPlaying NPCRobotEdELaser3D rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 12) ;JIPCCC
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacecombat"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacecraft"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdEFail rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacefail"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecolorblue"
		elseif (IsSoundPlaying NPCRobotEdESad rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleSad)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacesad"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecolorblue"
		elseif (IsSoundPlaying NPCRobotEdEGoodbyeSad rCurrEdeRef)
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\edefacegoodbyesad"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecolorblue"
		else
			SwapTexture rCurrEdeRef FaceA "AnimEDExFaceA\AnimEDExFaceA"
			SwapTexture rCurrEdeRef FaceC "AnimEDExFaceA\edecoloryellow"
		endif
	endif
	set EDEQuest.bIsAnimating to 0
End