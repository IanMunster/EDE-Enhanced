scn EDEAnimateScript

ref rCurrEdeRef
int bHasFacePlate

Begin Function { rCurrEdeRef }
	set EDEQuest.bIsAnimating to 1
	set bHasFacePlate to rCurrEdeRef.CreatureHasModel "AnimEDEFacePlate.nif"
	if (GetUnconscious) || (GetDead) 
		SwapTexture rCurrEdeRef Face "ehede\edefacedead"
		SwapTexture rCurrEdeRef Color "ehede\edecolorgrey"
	elseif (IsInCombat)
		SwapTexture rCurrEdeRef Face "ehede\edefaceAngry"
		SwapTexture rCurrEdeRef Color "ehede\edecolorred"
	elseif (EDEQuest.bIsCloaked == 1) && (bHasFacePlate == 1)	;// Remove FacePlate when Invisible
		rCurrEdeRef.ToggleCreatureModel "AnimEDEFacePlate.nif" 0
		rCurrEdeRef.Update3D
		set bHasFacePlate to 0
	elseif (EDEQuest.bIsCloaked == 0) && (bHasFacePlate == 0)	;// Add FacePlate when NOT Invisible
		rCurrEdeRef.ToggleCreatureModel "AnimEDEFacePlate.nif" 1
		rCurrEdeRef.Update3D
		set bHasFacePlate to 1
	else
		if (IsSoundPlaying NPCRobotEdEHappy rCurrEdeRef) || ((rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleHappy) && (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef == 0))
			SwapTexture rCurrEdeRef Face "ehede\edefacehappy"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdEConfirmed rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefaceyes"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdETriumphant rCurrEdeRef) || ((rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleHappy) && (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef == 0)) || (JIPCCCActiveTasks.iTask == 13) ;JIPCCC
			SwapTexture rCurrEdeRef Face "ehede\edefacetriumph"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdELaugh rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacelaugh"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdEGoodbyeHappy rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacegoodbyehappy"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdEHydaulicDoor rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacehelpfull"
			SwapTexture rCurrEdeRef Color "ehede\edecolorgreen"
		elseif (IsSoundPlaying NPCRobotEdEAlertLowHealth rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleScared)
			SwapTexture rCurrEdeRef Face "ehede\edefacepanic"
			SwapTexture rCurrEdeRef Color "ehede\edecolorred"
		elseif (IsSoundPlaying NPCRobotEdEDenied rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefaceNo"
			SwapTexture rCurrEdeRef Color "ehede\edecolorred"
		elseif (IsSoundPlaying NPCRobotEdEAnger rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleAngry)
			SwapTexture rCurrEdeRef Face "ehede\edefaceangry"
			SwapTexture rCurrEdeRef Color "ehede\edecolorred"
		elseif (IsSoundPlaying NPCRobotEdECurious rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacecurious"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdEAlertThreat rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefaceseek"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdESonarBeep rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 9) || (JIPCCCActiveTasks.iTask == 10) ;JIPCCC
			SwapTexture rCurrEdeRef Face "ehede\edefacesneak"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdEHomingBeep rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 8) || (JIPCCCActiveTasks.iTask == 11) ;JIPCCC
			SwapTexture rCurrEdeRef Face "ehede\edefacefollow"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdELaser3D rCurrEdeRef) || (JIPCCCActiveTasks.iTask == 12) ;JIPCCC
			SwapTexture rCurrEdeRef Face "ehede\edefacecombat"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdESeeking rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacecraft"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		elseif (IsSoundPlaying NPCRobotEdEFail rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacefail"
			SwapTexture rCurrEdeRef Color "ehede\edecolorblue"
		elseif (IsSoundPlaying NPCRobotEdESad rCurrEdeRef) || (rCurrEdeRef.IsIdlePlayingEx EDESpecialIdleSad)
			SwapTexture rCurrEdeRef Face "ehede\edefacesad"
			SwapTexture rCurrEdeRef Color "ehede\edecolorblue"
		elseif (IsSoundPlaying NPCRobotEdEGoodbyeSad rCurrEdeRef)
			SwapTexture rCurrEdeRef Face "ehede\edefacegoodbyesad"
			SwapTexture rCurrEdeRef Color "ehede\edecolorblue"
		else
			SwapTexture rCurrEdeRef Face "ehede\edefaceidle"
			SwapTexture rCurrEdeRef Color "ehede\edecoloryellow"
		endif
	endif
	set EDEQuest.bIsAnimating to 0
End